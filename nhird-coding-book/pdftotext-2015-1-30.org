* pdftotext

** table of contents

| source |                             |                        |
|  block | content                     | block name             |
|--------+-----------------------------+------------------------|
|     05 | blank, sh, session, raw     |                        |
|        |                             |                        |
|     15 | define file name to process | the_pdf_name_block     |
|        |                             | <<the_pdf_name_block>> |
|        |                             |                        |
|     17 | extract pdf content         |                        |
|        |                             |                        |
|        |                             |                        |
|      A |                             |                        |
|        |                             |                        |
|        |                             |                        |


** source block 05, blank template, session, raw, sh

| step | goal                     | target           |
|------+--------------------------+------------------|

#+NAME:
#+HEADERS: :session
#+HEADERS: :results raw
#+BEGIN_SRC sh


#+END_SRC

#+RESULTS:


** source block 07, long variable assignment

| step | goal                     | target           |
|------+--------------------------+------------------|

#+NAME:
#+HEADERS: :session
#+HEADERS: :results raw
#+BEGIN_SRC sh

test=$(printf 
'1'
2
3
)

# echo $test 

echo $test | sed -r 's/([0-9]) /\1 \n/g'

test1=$(echo $test | sed -r 's/([0-9]) /\1 \n/g')

echo 'test1 is' $test1

#+END_SRC

#+RESULTS:

test1 is
'1' 2 
3
test1 is '1' 2 3
1 
2 
3
test1 is 1 2 3
1 
2 
3
test1 is 1 2 3






** source block 15, define pdf file name #+NAME: the_pdf_name_block

| step | goal                     | target           |
|------+--------------------------+------------------|
|      | define the pdf file name | the_pdf_filename |
|      |                          |                  |
|      | print the file name      |                  |

#+NAME: the_pdf_name_block
#+HEADERS: :session
#+HEADERS: :results raw
#+BEGIN_SRC sh


 the_pdf_filename="en_codeformat.pdf"  #A
# the_pdf_filename="en_codedescribe.pdf"  #B


echo

# echo "\$the_pdf_filename is:" $the_pdf_filename

# echo "the_dir_under_home is" $the_dir_under_home

# echo "the_file_name is" $the_file_name

# echo "the_pdf_path is"  $the_pdf_path

# printf "The current directory, by default, through the command pwd, is: " ; pwd

#+END_SRC

#+RESULTS: the_pdf_name_block

$the_pdf_filename is: en_codeformat.pdf






** source block 17, extract raw text between page f, l through pdftotext

#+NAME: raw_output
#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
<<the_pdf_name_block>>

pdftotext -f 1 -l 3 -raw -nopgbrk $the_pdf_filename -
#+END_SRC


    

** source block 25, sed 

#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
 <<the_pdf_name_block>>

 raw_test=$(pdftotext -f 1 -l 2 -raw -nopgbrk $the_pdf_filename -)

 echo $raw_test

 echo $raw_test | sed -r 's/[.]{2,}/|/g' | sed -r 's/([0-9]+ )/\1\n/g'

#+END_SRC


** source block A.1 檔案格式及資料描述

#+NAME: raw_output
#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
<<the_pdf_name_block>>

pdftotext -f 1 -l 3 -raw -nopgbrk $the_pdf_filename -

#+END_SRC


    


** source block A.2 檔案格式及資料描述


V.102-11 

目 錄 

第一部份：檔案格式及資料描述 

| 醫事機構基本資料檔（HOSB）                            | A-1  |
| 醫事機構副檔資料檔（HOSX）                            | A-3  |
| 醫事機構服務項目檔（HOX）                             | A-5  |
| 醫事機構診療科別明細檔（DETA）                        | A-6  |
| 醫事機構病床主檔（BED）                               | A-7  |
| 醫事人員基本資料檔（PER）                             | A-8  |
| 專科醫師證書主檔（DOC）[適用 86～100 年資料]          | A-9  |
| 專科醫師證書主檔（DOC）[適用 101 年以後資料]          | A-10 |
| 評鑑資料檔（HOSP_GRAD）                               | A-11 |
| 醫事機構類別明細檔（HOSTDTL）                         | A-12 |
| 執業資料紀錄檔（LIC）                                 | A-13 |
| 重大傷病證明明細檔（HV）[適用 85～93 年資料]          | A-14 |
| 重大傷病證明明細檔（HV）[適用 94～98 年資料]          | A-15 |
| 重大傷病證明明細檔（HV）[適用 99~100 年以後資料]      | A-16 |
| 重大傷病證明明細檔（HV）[適用 101 年以後資料]         | A-17 |
| 門診費用申請總表主檔（CT）[適用 100 年以前資料]       | A-18 |
| 門診費用申請總表主檔（CT）[適用 101 年以後資料]       | A-20 |
| 住院費用申請總表主檔（DT）[適用 100 年以前資料]       | A-22 |
| 住院費用申請總表主檔（DT）[適用 101 年以後資料]       | A-23 |
| 門診處方及治療明細檔（CD）[適用 86～92 年資料]        | A-25 |
| 門診處方及治療明細檔（CD）[適用 93~100 年資料]        | A-30 |
| 門診處方及治療明細檔（CD）[適用 101 年以後資料]       | A-35 |
| 門診處方醫令明細檔（OO）[適用 85～95 年資料]          | A-41 |
| 門診處方醫令明細檔（OO）[適用 96~100 年資料]          | A-43 |
| 門診處方醫令明細檔（OO）[適用 101 年以後資料]         | A-46 |
| 住院醫療費用清單明細檔（DD）[適用 85～92 年資料]      | A-50 |
| 住院醫療費用清單明細檔（DD）[適用 93～95 年資料]      | A-55 |
| 住院醫療費用清單明細檔（DD）[適用 96~100 年資料]      | A-60 |
| 住院醫療費用清單明細檔（DD）[適用 101 年以後資料]     | A-65 |
| 住院醫療費用醫令清單明細檔（DO）[適用 85～95 年資料]  | A-71 |
| 住院醫療費用醫令清單明細檔（DO）[適用 96～98 年資料]  | A-72 |
| 住院醫療費用醫令清單明細檔（DO）[適用 99~100 年資料]  | A-74 |
| 住院醫療費用醫令清單明細檔（DO）[適用 101 年以後資料] | A-76 |
| 特約藥局處方及調劑明細檔（GD）[適用 85～87 年資料]    | A-79 |
| 特約藥局處方及調劑明細檔（GD）[適用 88～92 年資料]    | A-80 |
| 特約藥局處方及調劑明細檔（GD）[適用 93～98 年資料]    | A-82 |
| 特約藥局處方及調劑明細檔（GD）[適用 99~100 年資料]    | A-84 |
| 特約藥局處方及調劑明細檔（GD）[適用 101 年以後資料]   | A-86 |
| 特約藥局處方調劑醫令檔（GO）[適用 85～95 年資料]      | A-88 |
| 特約藥局處方調劑醫令檔（GO）[適用 96~100 年資料]      | A-89 |
| 特約藥局處方調劑醫令檔（GO）[適用 101 年以後資料]     | A-90 |
| 物理治療所調劑明細檔（GDD）                           | A-91 |
| 物理治療所調劑醫令檔（GOO）                           | A-93 |
| 承保資料檔（ID）[適用 98 年以前資料]                  | A-94 |
| 承保資料檔（ID）[適用 99 年以後資料]                  | A-96 |
| 藥品主檔（DRUG）                                      | A-97 |

※本譯碼簿僅供參考，資料描述或代碼說明資訊如有異動，請逕自全民健康保險 署網站（http://www.nhi.gov.tw/ ）查閱。



#+NAME: raw_output
#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
<<the_pdf_name_block>>

# pdftotext -f 1 -l 3 -raw -nopgbrk $the_pdf_filename -

raw_test=$(pdftotext -f 1 -l 3 -raw -nopgbrk $the_pdf_filename -)

#  echo $raw_test
#  echo $raw_test | sed -r 's/[.]{2,}/,/g'
  echo $raw_test | sed -r 's/[.]{2,}/,/g' | sed -r 's/(A-[0-9]+ )/\1\n/g'

#+END_SRC




** DONE source block A-1 醫事機構基本資料檔 HOSB

https://www.gnu.org/software/gawk/manual/html_node/Output-Separators.html

awk 'BEGIN { OFS = ";"; ORS = "\n\n" }
>            { print $1, $2 }' mail-list

awk 'BEGIN { OFS = ", "}{ print $1, $2 }' mail-list

#+NAME: raw_output
#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
<<the_pdf_name_block>>

# pdftotext -f 4 -l 5 -raw -nopgbrk $the_pdf_filename -

  raw_test=$(pdftotext -f 5 -l 6 -raw -nopgbrk $the_pdf_filename -)

 echo $raw_test
 echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g'
 echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15}'
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk ' { OFS = ", "}{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15 }'
#  echo $raw_test | sed -r 's/[.]{2,}/,/g' | sed -r 's/(A-[0-9]+ )/\1\n/g'

#+END_SRC


** DONE source block A-8 醫事人員基本資料檔 PER 

#+NAME: raw_output
#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
<<the_pdf_name_block>>

# pdftotext -f 12 -l 12 -raw -nopgbrk $the_pdf_filename -

  raw_test=$(pdftotext -f 12 -l 12 -raw -nopgbrk $the_pdf_filename -)

 echo $raw_test
 echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g'
 echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15}'
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk ' { OFS = ", "}{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15 }'
#  echo $raw_test | sed -r 's/[.]{2,}/,/g' | sed -r 's/(A-[0-9]+ )/\1\n/g'

#+END_SRC


** DONE source block A-9 專科醫師證書主檔 DOC 

#+NAME: raw_output
#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
<<the_pdf_name_block>>

# pdftotext -f 12 -l 12 -raw -nopgbrk $the_pdf_filename -

  raw_test=$(pdftotext -f 13 -l 14 -raw -nopgbrk $the_pdf_filename -)

# echo $raw_test
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g'
 echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15$16$17$18$19$20$21$22$23$24$25$26$27$28$29$30}'
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk ' { OFS = ", "}{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15 }'
#  echo $raw_test | sed -r 's/[.]{2,}/,/g' | sed -r 's/(A-[0-9]+ )/\1\n/g'

#+END_SRC





** DONE source block A-14 重大傷病證明明細檔 HV 

#+NAME: raw_output
#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
<<the_pdf_name_block>>

# pdftotext -f 12 -l 12 -raw -nopgbrk $the_pdf_filename -

  raw_test=$(pdftotext -f 18 -l 21 -raw -nopgbrk $the_pdf_filename -)

# echo $raw_test
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g'
 echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15$16$17$18$19$20$21$22$23$24$25$26$27$28$29$30$31$32$33$34$35$36$37$38$39$40}'
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk ' { OFS = ", "}{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15 }'
#  echo $raw_test | sed -r 's/[.]{2,}/,/g' | sed -r 's/(A-[0-9]+ )/\1\n/g'

#+END_SRC




** DONE source block A-17 執業資料紀錄檔 LIC 

#+NAME: raw_output
#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
<<the_pdf_name_block>>

# pdftotext -f 18 -l 18 -raw -nopgbrk $the_pdf_filename -

  raw_test=$(pdftotext -f 17 -l 17 -raw -nopgbrk $the_pdf_filename -)

# echo $raw_test
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g'
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15$16$17$18$19$20$21$22$23$24$25$26$27$28$29$30$31$32$33$34$35$36$37$38$39$40}'

 echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15$16$17$18$19$20$21$22$23$24$25$26$27$28$29$30$31$32$33$34$35$36$37$38$39$40}' | \ sed -r 's/序號英文欄位中文欄位資料型態長度起始位置迄末位置資料描述/\n\n序號 英文欄位 中文欄位 資料型態 長度 起始位置 迄末位置 資料描述/g'

#+END_SRC


** DONE source block A-18 門診費用申請總表主檔 CT 

#+NAME: raw_output
#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
<<the_pdf_name_block>>

# pdftotext -f 18 -l 18 -raw -nopgbrk $the_pdf_filename -

  raw_test=$(pdftotext -f 22 -l 25 -raw -nopgbrk $the_pdf_filename -)

# echo $raw_test
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g'
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15$16$17$18$19$20$21$22$23$24$25$26$27$28$29$30$31$32$33$34$35$36$37$38$39$40}'

 echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15$16$17$18$19$20$21$22$23$24$25$26$27$28$29$30$31$32$33$34$35$36$37$38$39$40}' | sed -r 's/序號英文欄位中文欄位資料型態長度起始位置迄末位置資料描述/\n\n序號 英文欄位 中文欄位 資料型態 長度 起始位置 迄末位置 資料描述/g'

#+END_SRC






** DONE source block A-22 住院費用申請總表主檔 DT 

#+NAME: raw_output
#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
<<the_pdf_name_block>>

# pdftotext -f 18 -l 18 -raw -nopgbrk $the_pdf_filename -

  raw_test=$(pdftotext -f 26 -l 28 -raw -nopgbrk $the_pdf_filename -)

# echo $raw_test
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g'
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15$16$17$18$19$20$21$22$23$24$25$26$27$28$29$30$31$32$33$34$35$36$37$38$39$40}'

 echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15$16$17$18$19$20$21$22$23$24$25$26$27$28$29$30$31$32$33$34$35$36$37$38$39$40}' | sed -r 's/序號英文欄位中文欄位資料型態長度起始位置迄末位置資料描述/\n\n序號 英文欄位 中文欄位 資料型態 長度 起始位置 迄末位置 資料描述/g'

#+END_SRC




** DONE source block

#+NAME: raw_output
#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
<<the_pdf_name_block>>

  raw_test=$(pdftotext -f 29 -l 34 -raw -nopgbrk $the_pdf_filename -)

# echo $raw_test
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g'
# echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15$16$17$18$19$20$21$22$23$24$25$26$27$28$29$30$31$32$33$34$35$36$37$38$39$40}'

 echo $raw_test | sed -r 's/( [0-9]{1,2} [A-XZ])/\n\1/g' | awk '{print $1, $2, $3, $4, $5, $6, $7, $8$9$10$11$12$13$14$15$16$17$18$19$20$21$22$23$24$25$26$27$28$29$30$31$32$33$34$35$36$37$38$39$40}' | sed -r 's/序號英文欄位中文欄位資料型態長度起始位置迄末位置資料描述/\n\n序號 英文欄位 中文欄位 資料型態 長度 起始位置 迄末位置 資料描述/g'

#+END_SRC

#+RESULTS: raw_output

A-25 門診處方及治療明細檔 CD 


中文檔案名稱：門診處方及治療明細檔

英文檔案名稱： CD

（適用 85～92 年資料） 

長度 300


| 序號 | 英文欄位       | 中文欄位               | 資料型態 | 長度 | 起始位置 | 迄末位置 | 資料描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|------+----------------+------------------------+----------+------+----------+----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    1 | FEE_YM         | 費用年月               | C        |    6 |        1 |        6 | YYYYMM                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|    2 | APPL_TYPE      | 申報類別               | C        |    1 |        7 |        7 | 1：送核2：補報                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|    3 | HOSP_ID        | 醫事機構代號           | C        |   34 |        8 |       41 | 已轉碼。後2碼為權屬別，請參考代碼說明B-4之「權屬及型態別其代號與名稱」。代檢及轉檢由原診治之特約醫院、診所申報。                                                                                                                                                                                                                                                                                                                                                          |
|    4 | APPL_DATE      | 申報日期               | C        |    8 |       42 |       49 | YYYYMMDD(西元年)                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|    5 | CASE_TYPE      | 案件分類               | C        |    2 |       50 |       51 | 請參考代碼說明B-26之「案件分類代號」                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|    6 | SEQ_NO         | 流水號                 | N        |    6 |       52 |       57 | 右靠不足補0，依案件分類之類別分別連續編號                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|    7 | CURE_ITEM_NO1  | 特定治療項目代號（一） | C        |    2 |       58 |       59 | 請參考代碼說明B-55之「特定治療項目代號」；如無特定治療項目代號所列舉之內容則留空白。慢性病連續處方調劑本欄免填。                                                                                                                                                                                                                                                                                                                                                          |
|    8 | CURE_ITEM_NO2  | 特定治療項目代號（二） | C        |    2 |       60 |       61 | 同上                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|    9 | CURE_ITEM_NO3  | 特定治療項目代號（三） | C        |    2 |       62 |       63 | 同上                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|   10 | CURE_ITEM_NO4  | 特定治療項目代號（四） | C        |    2 |       64 |       65 | 同上                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|   11 | FUNC_TYPE      | 就醫科別               | C        |    2 |       66 |       67 | 請參考代碼說明B-49之「就醫科別及細分科」                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|   12 | FUNC_DATE      | 就醫日期               | C        |    8 |       68 |       75 | YYYYMMDD請參考代碼說明B-63之「就醫日期及治療結束日期補充說明」                                                                                                                                                                                                                                                                                                                                                                                                            |
|   13 | TREAT_END_DATE | 治療結束日期           | C        |    8 |       76 |       83 | YYYYMMDD請參考代碼說明B-63之「就醫日期及治療結束日期補充說明」，同一療程、排程檢查或慢性病連續處方籤調劑案件，本欄必填。                                                                                                                                                                                                                                                                                                                                                  |
|   14 | ID_BIRTHDAY    | 出生年月               | C        |    8 |       84 |       91 | YYYYMM,左靠不足補空白                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|   15 | ID             | 身份證統一編號         | C        |   32 |       92 |      123 | 已轉碼，國民身分證統一編號，或外籍居留證號碼，左靠不足補空白，（如無居留證號碼則為護照號碼）。                                                                                                                                                                                                                                                                                                                                                                            |
|   16 | CARD_SEQ_NO    | 健保卡就醫序號         | C        |    2 |      124 |      125 | 健保卡或兒童健康手冊就醫紀錄欄之序號(如：A1、A2)，同一序號如有重複申報，僅支付實際於就醫紀錄欄加蓋戳章之醫療院所，慢性病連續處方調劑請填慢性病連續處方箋上調劑記錄欄之序號，(左靠不足補空白)；預防保健請填預防保健之服務時程代碼；請參考代碼說明B-35之「健保卡就醫序號」請忽略C1126126                                                                                                                                                                                    |
|   17 | GAVE_KIND      | 給付類別               | C        |    1 |      127 |      127 | 請參考說明B-64之「給付類別」                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|   18 | PART_NO        | 部分負擔代號           | C        |    3 |      128 |      130 | 部分負擔代號依部分負擔代號之編碼原則填寫。請參考代碼說明B-40之「部分負擔代號及相關規定」。本欄為必要欄位，如為慢性病連續處方調劑及預防保健，本欄請填009                                                                                                                                                                                                                                                                                                                   |
|   19 | ACODE_ICD9_1   | 國際疾病分類號一       | C        |    5 |      131 |      135 | 左靠不足補空白，西醫、中醫國際疾病分類號碼按傷病名稱，參照世界衛生組織一九七五年第九次修訂之國際疾病分類表(Acode)填寫，亦可填ICD-9-CM，最多填三個；牙醫則填ICD-9-CM，預防保健則本欄為非必要欄位西醫自八十九年元月起全面以ICD-9-CM申報；中醫自九十一年五月起全面以ICD-9-CM申報。ICD-9-CM以1992年版為準。95.01起ICD-9-CM以2001年版為準。
|   20 | ACODE_ICD9_2   | 國際疾病分類號二       | C        |    5 |      136 |      140 | 左靠，不足補空白                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|   21 | ACODE_ICD9_3   | 國際疾病分類號三       | C        |    5 |      141 |      145 | 左靠，不足補空白                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|   22 | ICD_OP_CODE    | 主手術代碼             | C        |    4 |      146 |      149 | ICD-9-CM之主手術代號；預防保健、慢性病連續處方調劑及中醫本欄免填                                                                                                                                                                                                                                                                                                                                                                                                          |
|   23 | DRUG_DAY       | 給藥日份               | N        |    2 |      150 |      151 | 右靠不足補0，本次給藥日份最高之天數（註一）：除單次給藥為「非口服藥」外，餘請填「口服藥」之最高給藥日份(89.06)；慢性病連續處方調劑，請依連續處方箋上所列填寫；預防保健則本欄為非必要欄位                                                                                                                                                                                                                                                                                  |
|   24 | MED_TYPE       | 處方調劑方式           | C        |    1 |      152 |      152 | 請參考代碼說明B-65之「處方調劑方式」                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|   25 | PRSN_ID        | 醫師代號               | C        |   32 |      153 |      184 | 已轉碼。醫師或原處方醫師之國民身分證統一編號或外籍居留證號。左靠不足補空白。                                                                                                                                                                                                                                                                                                                                                                                              |
|   26 | PHAR_ID        | 藥師代號               | C        |   32 |      185 |      216 | 已轉碼。調劑藥師之國民身分證統一編號，外籍居留證號，左靠不足補空白。診所聘有藥師本欄為必要欄位，否則留空白。                                                                                                                                                                                                                                                                                                                                                              |
|   27 | DRUG_AMT       | 用藥明細點數小計       | N        |    8 |      217 |      224 | 右靠不足補0，此項費用為OO檔之醫令類別為１之用藥明細點數(序號13)之小計，如為交付調劑之藥品費用，不得併入用藥明細點數小計內計算；西醫簡表及中醫請依給藥日份計算用藥申報點數                                                                                                                                                                                                                                                                                                 |
|   28 | TREAT_AMT      | 診療明細點數小計       | N        |    8 |      225 |      232 | 右靠不足補0，此項費用為OO檔之除用藥之外（醫令類別為2或3），各項診療及特殊材料明細點數（序號13）之小計；慢性病連續處方調劑本欄免填                                                                                                                                                                                                                                                                                                                                         |
|   29 | TREAT_CODE     | 診察費項目代號         | C        |   12 |      233 |      244 | 填寫全民健保醫療費用支付標準碼。預防保健、洗腎、慢性病連續處方調劑本欄免填，補空白                                                                                                                                                                                                                                                                                                                                                                                        |
|   30 | DIAG_AMT       | 診察費                 | N        |    8 |      245 |      252 | 診察費點數，右靠不足補0。預防保健、洗腎、慢性病連續處方調劑本欄免填，請補0                                                                                                                                                                                                                                                                                                                                                                                                |
|   31 | DSVC_NO        | 藥事服務費項目代號     | C        |   12 |      253 |      264 | 填寫全民健保醫療費用支付標準碼，洗腎本欄免填，補空白                                                                                                                                                                                                                                                                                                                                                                                                                      |
|   32 | DSVC_AMT       | 藥事服務費             | N        |    8 |      265 |      272 | 藥事服務費點數，右靠不足補0，洗腎本欄補0                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|   33 | BY_PASS_CODE   | DRG參考碼              | C        |    2 |      273 |      274 | 請參考健保署網站(http://www.nhi.gov.tw/)                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|   34 | T_AMT          | 合計點數               | N        |    8 |      275 |      282 | 右靠不足補0，此項費用含部分負擔費用，如為交付調劑之藥品費用，不得併入合計點數內計算，本欄為序號27、28、30、32之合計                                                                                                                                                                                                                                                                                                                                                       |
|   35 | PART_AMT       | 部分負擔點數           | N        |    8 |      283 |      290 | 右靠不足補0，部分負擔費用。預防保健、慢性病連續處方調劑本欄免填。補0                                                                                                                                                                                                                                                                                                                                                                                                      |
|   36 | T_APPL_AMT     | 申請點數               | N        |    8 |      291 |      298 | 右靠不足補0，此項費用不含部分負擔費用，即合計點數扣除部分負擔點數                                                                                                                                                                                                                                                                                                                                                                                                         |
|   37 | ID_SEX         | 性別                   | C        |    1 |      299 |      299 | M：男性F：女性U：不詳(詳註)                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|      |                |                        |          |      |      299 |          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

註：“性別”欄為中央健康保險署自行產製之欄位，當“身分證統一編號”欄長度為10碼者，才由第二碼判定，其餘皆為U（不詳）。

註一：「給藥日份」欄位，申報定義如后：


1.單次處方給藥僅開立「非口服藥」等外用藥物，以外用藥等之最高給藥天數申報；單次處方給藥僅開立「口服藥」或「口服藥」等外用藥物，以外用藥等之最高給藥天數申報；單次處方給藥僅開立「口服藥」或「非口服藥」等外用藥物併用，則應以「口服藥」用藥品項最高之天數申報。2.領有慢性病連續處方籤，出具出國證明（如機票等）一次領取兩個月用藥量時，請以乙次批價作業、併報方式辦理，即「給藥日份」填報兩個月藥量，「藥事服務費」欄位填報兩次藥事服務費之加總，「藥事服務費項目代號欄位」依原支付標準調劑項目代碼申報（如A-29V.102-1105209A、05210B等）。註二：門診（或急診）當次轉住院，如仍由同科醫師診治時，健保卡使用一格，其費用應以合併於住院費用申報為原則；如由門診或急診部門轉住院（或門診）時，非經同科醫師診治，其門、住診費用可分別列報,視同另次診療,健保卡分別各蓋院所日期戳章（業務須知第三頁第七點）註三：門診（或急診）當次轉住院之病人雖經「同科」不同醫師診治同一病患時，因仍屬「同科」之醫師診治，故門診診察費與急性病房住院診察費僅可擇一申報。（87.11.3健保醫字第八七Ｏ二八七五一號函）
1 FEE_YM 費用年月 C 6 1 6 YYYYMM
2 APPL_TYPE 申報類別 C 1 7 7 1：送核2：補報
3 HOSP_ID 醫事機構代號 C 34 8 41 已轉碼。後2碼為權屬別，請參考代碼說明之B-4「權屬及型態別其代號與名稱」代檢及轉檢由原診治之特約醫院、診所申報。
4 APPL_DATE 申報日期 C 8 42 49 YYYYMMDD(西元年)
5 CASE_TYPE 案件分類 C 2 50 51 請參考代碼說明B-26之「案件分類代號」
6 SEQ_NO 流水號 N 6 52 57 右靠不足補0，依案件分類之類別分別連續編號
7 CURE_ITEM_NO1 特定治療項目代號（一） C 2 58 59 請參考代碼說明B-55之「特定治療項目代號」；如無特定治療項目代號所列舉之內容則留空白。慢性病連續處方調劑本欄免填。
8 CURE_ITEM_NO2 特定治療項目代號（二） C 2 60 61 同上
9 CURE_ITEM_NO3 特定治療項目代號（三） C 2 62 63 同上
10 CURE_ITEM_NO4 特定治療項目代號（四） C 2 64 65 同上
11 FUNC_TYPE 就醫科別 C 2 66 67 請參考代碼說明B-49之「就醫科別及細分科」
12 FUNC_DATE 就醫日期 C 8 68 75 YYYYMMDD請參考代碼說明之B-63「就醫日期及治療結束日期補充說明」
13 TREAT_END_DAT E 治療結束日期 C 8 76 83YYYYMMDD請參考代碼說明B-63之「就醫日期及治療結束日期補充說明」，同一療程、排程檢查或慢性病連續處方籤調劑案件，本欄必填。
14 ID_BIRTHDAY 出生年月 C 8 84 91 YYYYMM,左靠不足補空白



** source block B, 代碼說明 B

#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
 <<the_pdf_name_block>>

 raw_test=$(pdftotext -f 1 -l 2 -raw -nopgbrk $the_pdf_filename -)



  echo $raw_test
  echo $raw_test | sed -r 's/[.]{2,}/|/g'
  echo $raw_test | sed -r 's/[.]{2,}/|/g' | sed -r 's/([0-9]+ )/\1\n/g'

#+END_SRC


** source block B-1, 評鑑等級

#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
 <<the_pdf_name_block>>

 raw_test=$(pdftotext -f 3 -l 4 -nopgbrk -raw $the_pdf_filename -)

#  echo $raw_test | sed -r 's/([0-79][0-9]) /\n\1, /g'
#  echo $raw_test | sed -r 's/([0-79][0-9]) /\n\1, /g' | sed -r 's/( 8[89] )/,\1/g'
   echo $raw_test | sed -r 's/([0-79][0-9]) /\n\1, /g' | sed -r 's/( 8[89] )/,\1/g' | sed -r 's/( 評鑑制度 )/,\1/g' 


#+END_SRC







 

** source block B-3, 特約類別

#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
 <<the_pdf_name_block>>

            pdftotext -f 5 -l 5 -nopgbrk -raw $the_pdf_filename -

#+END_SRC




 

** source block B-4, 權屬別及型態別其代號與名稱

#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
 <<the_pdf_name_block>>

            pdftotext -f 6 -l 10 -nopgbrk -raw $the_pdf_filename -

#+END_SRC

#+RESULTS:
B-4 權屬別及型態別其代號與名稱

一、醫療機構

| 權屬別 |                              |
|     01 | 署、市立醫院                 |
|     02 | 縣市立醫院                   |
|     04 | 公立醫學院校附設醫院         |
|     05 | 軍方醫院(民眾診療)           |
|     06 | 榮民醫院                     |
|     07 | 機關(構)附設醫院             |
|     08 | 公立中醫醫院                 |
|     09 | 社團法人醫院                 |
|     10 | 宗教社團法人附設醫院         |
|     11 | 財團法人醫院                 |
|     12 | 宗教財團法人附設醫院         |
|     13 | 私立醫學院校附設醫院         |
|     14 | 其他法人附設醫院             |
|     15 | 私立醫院                     |
|     17 | 私立牙醫醫院                 |
|     18 | 私立中醫院                   |
|     21 | 市立診所                     |
|     22 | 縣市立診所                   |
|     23 | 衛生所                       |
|     24 | 公立學校附設醫務室           |
|     25 | 軍方診所(民眾診療附設門診部) |
|     26 | 榮民診所(榮家醫務室)         |
|     27 | 機關(構)附設醫務室           |
|     28 | 公立中醫診所                 |
|     29 | 公益法人所設診所             |
|     30 | 公益法人所設醫務室           |
|     31 | 財團法人附設醫務室           |
|     32 | 宗教財團法人附設診所、醫務室 |
|     33 | 私立學校附設醫務室           |
|     34 | 事業單位附設醫務室           |
|     35 | 私立診所                     |
|     37 | 私立牙醫診所                 |
|     38 | 私立中醫診所                 |
|     40 | 醫療財團法人診所             |
|     41 | 醫療社團法人診所             |
|     42 | 財團法人其他醫療機構         |
|     45 | 私立其他醫療機構             |


|              型態別 |                  |
|---------------------+------------------|
|         醫院：01-08 |                  |
|                  01 | 綜合醫院         |
|                  02 | 醫院             |
|                  03 | 專科醫院         |
|                  04 | 精神科醫院       |
|                  05 | 特殊科醫院       |
|                  06 | 慢性醫院         |
|                  07 | 專科診所         |
|                  08 | 一般診所(醫務室) |
|                  09 | 特殊科診所       |
|---------------------+------------------|
|         牙醫：11-13 |                  |
|                  11 | 牙醫醫院         |
|                 B-5 |                  |
|                  12 | 牙醫專科診所     |
|                  13 | 牙醫一般診所     |
|---------------------+------------------|
|         中醫：21-24 |                  |
|                  21 | 中醫綜合醫院     |
|                  22 | 中醫醫院         |
|                  23 | 中醫專科診所     |
|                  24 | 中醫一般診所     |
|---------------------+------------------|
| 其他醫療機構：41-43 |                  |
|                  41 | 捐血中心         |
|                  42 | 捐血站           |
|                  43 | 病理中心         |

二、藥商

|            權屬別 |                |
|-------------------+----------------|
| 販賣業：51-53、62 |                |
|                51 | 西藥販賣業     |
|                52 | 中藥販賣業     |
|                53 | 醫療器材販賣業 |
|                62 | 販賣業         |
|-------------------+----------------|
| 製造業：54-58、61 |                |
|                54 | 西藥製造業     |
|                55 | 中藥製造業     |
|                56 | 醫療器材製造業 |
|                57 | 明膠膠囊製造業 |
|                58 | 化妝品製造業   |
|                61 | 製造業         |
|-------------------+----------------|
|       其他：59-60 |                |
|                59 | 藥局           |
|                60 | 列冊中藥商     |



| 型態別 |                                    |
|--------+------------------------------------|
|     01 | 藥師自營                           |
|     02 | 藥劑生自營                         |
|     03 | 藥師駐店管理                       |
|     04 | 藥劑生駐店管理                     |
|     05 | 符合藥事法104條規定─藥師管理       |
|     06 | 符合藥事法104條規定─藥劑生管理     |
|     07 | 中醫師駐店管理                     |
|     08 | 中醫師兼管                         |
|     09 | 藥師兼管                           |
|     11 | 確具中藥基本知識及鑑別能力人員管理 |
|     12 | 人用生物藥品製造廠                 |
|     13 | 藥師監製                           |
|     14 | 中醫師監製                         |
|     16 | 列冊中藥商                         |


三、護理護產機構


| 權屬別 |                              |
|--------+------------------------------|
|     71 | 公立護產機構                 |
|     72 | 財團法人護產機構             |
|     73 | 其他法人附設護產機構         |
|     74 | 個人開設護產機構             |
|     75 | 公立醫療機構附設護產機構     |
|     76 | 私立醫療機構附設護產機構     |
|     77 | 財團法人醫療機構附設護產機構 |
|     78 | 其他                         |
|     79 | 社團法人醫療機構附設護產機構 |


| 型態別 |                            |
|--------+----------------------------|
|     01 | 護理之家                   |
|     02 | 居家護理                   |
|     03 | 產後護理                   |
|     04 | 助產所                     |
|     05 | 學校醫務室─校護            |
|     06 | 事業單位醫務室─廠護        |
|     07 | 社會福利機構               |
|     08 | 機關醫護室                 |
|     09 | 學校護理教育(實習指導老師) |
|     10 | 日間照護                   |
|     00 | 其他                       |


四、精神復健機構

| 權屬別 |                                  |
|--------+----------------------------------|
|     81 | 公立精神復健機構                 |
|     82 | 財團法人精神復健機構             |
|     83 | 其他法人附設精神復健機構         |
|     84 | 私立精神復健機構                 |
|     85 | 公立醫療機構附設精神復健機構     |
|     86 | 私立醫療機構附設精神復健機構     |
|     87 | 財團法人醫療機構附設精神復健機構 |
|     88 | 精神衛生團體附設精神復健機構     |


| 型態別 |              |
|--------+--------------|
|     08 | 社區復健中心 |
|     09 | 康復之家     |



五、其他醫事機構

| 權屬別 |                                  |
|--------+----------------------------------|
|     91 | 公立其他醫事機構                 |
|     92 | 財團法人其他醫事機構             |
|     93 | 其他法人附設其他醫事機構         |
|     94 | 私立其他醫事機構                 |
|     95 | 公立醫療機構附設其他醫事機構     |
|     96 | 私立醫療機構附設其他醫事機構     |
|     97 | 財團法人醫療機構附設其他醫事機構 |
|     98 | 其他                             |
|     xx | 不詳                             |



| 型態別 |                    |
|--------+--------------------|
|     01 | 醫事檢驗所         |
|     02 | 醫事放射所         |
|     03 | 物理治療所         |
|     04 | 職能治療所         |
|     05 | 鑲牙所             |
|     06 | 齒模製造技術員     |
|     07 | 國術損傷接骨技術員 |
|     00 | 其他               |
|     xx | 不詳               |



** source block B-53 專科醫師代號、科別

#+HEADERS: :noweb yes
#+HEADERS: :results raw
#+HEADERS: :session
#+BEGIN_SRC sh
#  the_pdf_filename="en_codeformat.pdf"  #A
 the_pdf_filename="en_codedescribe.pdf"  #B

            pdftotext -f 55 -l 56 -nopgbrk -raw $the_pdf_filename -

#+END_SRC

#+RESULTS:
B-53
專科醫師代號、科別
| 代號         | 專科別           |
| A0100        | 家庭醫學科       |
| A0200        | 內科             |
| A0201        | 心臟專科         |
| A0202        | 腎臟科           |
| A0203        | 胸腔暨重症專科   |
| A0204        | 心臟外專科       |
| A0205        | 心臟血管外科     |
| A0206        | 胸腔外科         |
| A0207        | 結核病專科       |
| A0208        | 感染症專科       |
| A02AA        | 新陳代謝科       |
| A0299        | 職業病科         |
| A0300        | 外科             |
| A0301        | 整形外科         |
| A0400        | 小兒科           |
| A0500        | 婦產科           |
| A0600        | 骨科             |
| A0700        | 神經科           |
| A0800        | 神經外科         |
| A0900        | 泌尿科           |
| A1000        | 耳鼻喉科         |
| A1100        | 眼科             |
| A1200        | 皮膚科           |
| A1300        | 精神科           |
| A1400        | 復健科           |
| A1500        | 麻醉科           |
| A1600        | 放射線科（診斷） |
| A1610        | 放射線科（腫瘤） |
| A1620        | 放射線科（核醫） |
| A2000        | 病理科（解剖）   |
| A2010        | 病理科（臨床）   |
| A2100        | 核子醫學科       |
| A0299        | 職業病科         |
| A2200        | 急診醫學科       |
| A2400        | 職業醫學科       |
| A2500        | 口腔顎面外科     |
| C0700        | 口腔顎面外科     |
| B0100        | 中醫內科         |
| B0200        | 中醫外科         |
| B0300        | 中醫婦科         |
| B0400        | 中醫兒科         |
| B0600        | 中醫眼科         |
| C0100        | 牙科不分科       |
| C0900        | 口腔病理科       |




** man pdftotext

pdftotext [options] [PDF-file [text-file]]


Options

-f number
    Specifies the first page to convert.

-l number
    Specifies the last page to convert.

-layout
    Maintain (as best as possible) the original physical layout of the text. The default is to 'undo' physical layout (columns, hyphenation, etc.) and output the text in reading order.

-raw
    Keep the text in content stream order.  This is a hack which often "undoes" column formatting, etc.  Use of raw mode is no longer recommended.





 
